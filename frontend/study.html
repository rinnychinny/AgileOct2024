<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Trainer</title>
    <script>
        async function getStudyMaterials() {
            const urlParams = new URLSearchParams(window.location.search);
            const fileIdsParam = urlParams.get('fileIds');

            if (!fileIdsParam) {
                document.getElementById('studyContainer').innerHTML = "<p>No study materials selected.</p>";
                return;
            }

            const fileIds = fileIdsParam.split(',');

            try {
                // Fetch file details from the server
                const response = await fetch(`/files/details?fileIds=${fileIds.join(',')}`);
                if (!response.ok) throw new Error("Failed to fetch file details");

                const files = await response.json();
                const container = document.getElementById('studyMaterials');
                container.innerHTML = ''; // Clear previous content

                // Create table structure
                const table = document.createElement('table');
                table.style.tableLayout = 'auto';
                table.border = '1';

                // Create table header
                const headerRow = document.createElement('tr');
                headerRow.innerHTML = `
                    <th>File ID</th>
                    <th>Source</th>
                `;
                table.appendChild(headerRow);

                // Append each file as a row in the table
                files.forEach(file => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${file.id}</td>
                        <td><a href="${file.filePath}" target="_blank">${file.source}</a></td>
                    `;
                    table.appendChild(row);
                });

                container.appendChild(table);
                
            } catch (error) {
                console.error("Error fetching study materials:", error);
                document.getElementById('studyMaterials').innerHTML = "<p>Error loading materials.</p>";
            }
        }

        window.onload = getStudyMaterials;
    </script>
</head>
<body>
    <h1>Study Trainer</h1>
    <div>
        <h2>Study Materials</h2>
        <div id="studyMaterials">Loading...</div>
    </div>
</body>
</html>
